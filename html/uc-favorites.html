<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>赫森-我的收藏</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <meta name="keywords" content="赫森">
    <meta name="description" content="赫森">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link type="text/css" rel="stylesheet" href="../assets/css/hesen.min.css">
    <script>(function(){var b=document.documentElement,a=function(){var a=b.getBoundingClientRect().width;b.style.fontSize=0.0625*(640<=a?640:a)+"px"},c=null;window.addEventListener("resize",function(){clearTimeout(c);c=setTimeout(a,300)});a()})();</script>
</head>
<body onload="loaded()">
<!-- Loading -->
<div id="loading" class="loading">
    <div class="toast"><div class="toast-text"><span class="toast-icon-loading"></span>加载中...</div></div>
</div>
<!-- // Loading -->
<!-- Header -->
<header class="header">
    <a href="javascript:history.go(-1);" class="left-back header-left"></a>
    <h1 class="header-title">我的收藏</h1>
</header>
<!-- // Header -->
<!-- Tab -->
<div class="tabs tabs-with-bor second-header-bar">
    <a href="#" class="active">收藏的商品</a>
    <a href="#">收藏的店铺</a>
</div>
<!-- // Tab -->
<!-- Tab Order -->
<div class="tab-order-control tab-with-action third-header-bar">
    <a href="#" class="control-item active">全部商品（302）</a>
    <a href="#" class="control-item">失效商品（30）</a>
    <a href="javascript:;" id="J_editBtn" class="btn-link">编辑</a>
</div>
<!-- Tab Order -->
<!-- Bar ShoppingCart -->
<div id="J_listAction" class="bar-shoppingcart">
    <div class="btn-outer">
        <button type="button" id="J_delBtn" class="btn btn-success btn-block btn-radius pull-right">删除</button>
    </div>
    <input type="checkbox" id="J_checkAll" class="icheck"><label for="J_checkAll">全选</label>
</div>
<!-- // Bar ShoppingCart -->
<!-- Content -->
<div id="wrapper">
    <div id="scroller">
        <div id="content" class="content">
            <!-- Favorites List -->
            <div id="J_listWrapper" class="favorites-list">
                <a href="#" class="with-check" data-pid="23">
                    <input type="checkbox" class="icheck">
                    <div class="with-check-inner">
                        <div class="item-cover" style="background-image: url(../assets/upload/fruit_5.jpg)">
                            <span class="state-sold-out">已失效</span>
                        </div>
                        <div class="main-info">
                            <div class="txt">现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个</div>
                            <div class="price">¥39.00</div>
                        </div>
                    </div>
                </a>
                <a href="#" class="with-check" data-pid="24">
                    <input type="checkbox" class="icheck">
                    <div class="with-check-inner">
                        <div class="item-cover" style="background-image: url(../assets/upload/fruit_5.jpg)">
                        </div>
                        <div class="main-info">
                            <div class="txt">现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个</div>
                            <div class="price">¥39.00</div>
                        </div>
                    </div>
                </a>
                <a href="#" class="with-check" data-pid="25">
                    <input type="checkbox" class="icheck">
                    <div class="with-check-inner">
                        <div class="item-cover" style="background-image: url(../assets/upload/fruit_5.jpg)">
                        </div>
                        <div class="main-info">
                            <div class="txt">现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个</div>
                            <div class="price">¥39.00</div>
                        </div>
                    </div>
                </a>
                <a href="#" class="with-check" data-pid="26">
                    <input type="checkbox" class="icheck">
                    <div class="with-check-inner">
                        <div class="item-cover" style="background-image: url(../assets/upload/fruit_5.jpg)">
                        </div>
                        <div class="main-info">
                            <div class="txt">现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个</div>
                            <div class="price">¥39.00</div>
                        </div>
                    </div>
                </a>
                <a href="#" class="with-check" data-pid="27">
                    <input type="checkbox" class="icheck">
                    <div class="with-check-inner">
                        <div class="item-cover" style="background-image: url(../assets/upload/fruit_5.jpg)">
                        </div>
                        <div class="main-info">
                            <div class="txt">现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个</div>
                            <div class="price">¥39.00</div>
                        </div>
                    </div>
                </a>
                <a href="#" class="with-check" data-pid="28">
                    <input type="checkbox" class="icheck">
                    <div class="with-check-inner">
                        <div class="item-cover" style="background-image: url(../assets/upload/fruit_5.jpg)">
                        </div>
                        <div class="main-info">
                            <div class="txt">现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个</div>
                            <div class="price">¥39.00</div>
                        </div>
                    </div>
                </a>
                <a href="#" class="with-check" data-pid="29">
                    <input type="checkbox" class="icheck">
                    <div class="with-check-inner">
                        <div class="item-cover" style="background-image: url(../assets/upload/fruit_5.jpg)">
                        </div>
                        <div class="main-info">
                            <div class="txt">现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个</div>
                            <div class="price">¥39.00</div>
                        </div>
                    </div>
                </a>
                <a href="#" class="with-check" data-pid="30">
                    <input type="checkbox" class="icheck">
                    <div class="with-check-inner">
                        <div class="item-cover" style="background-image: url(../assets/upload/fruit_5.jpg)">
                        </div>
                        <div class="main-info">
                            <div class="txt">现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个现摘云南蒙自石榴薄皮多汁软籽很甜 新鲜水果特产石榴礼盒12个</div>
                            <div class="price">¥39.00</div>
                        </div>
                    </div>
                </a>
            </div>
            <!-- // Favorites List -->
            <!-- Null -->
            <div class="list-null">
                <div class="txt">您的收藏夹是空的</div>
                <div class="intro">暂时没有相关数据</div>
            </div>
            <!-- // Null -->
        </div>
    </div>
</div>
<!-- // Content -->
<script src="../assets/js/iscroll-probe.js"></script>
<script src="../assets/js/jquery-2.1.4.min.js"></script>
<script src="../assets/js/hesen.js"></script>
<script>
    var $J_checkAll = $('#J_checkAll');
    var $J_listWrapper = $('#J_listWrapper');
    var $J_delBtn = $('#J_delBtn');

    $('#J_editBtn').on('click',function(){
        if ($(this).hasClass('on')){
            window.location.reload();
        } else {
            $(this).html('完成').addClass('on');
            $J_listWrapper.addClass('edit');
            $('#J_listAction').addClass('active');
            myScroll_0.refresh();
        }
    });


    /*
     * 收藏编辑全选
     * */
    $J_checkAll.on('change',function(){
        var _this = $(this);
        if (_this.prop('checked')) {
            $J_listWrapper.find('.with-check').addClass('selected');
            $J_listWrapper.find('.icheck:not(:checked)').prop('checked',true);
        } else {
            $J_listWrapper.find('.with-check').removeClass('selected');
            $J_listWrapper.find('.icheck:checked').prop('checked',false);
        }
    });

    /*
     * icheck选择
     * */
    $J_listWrapper.on('change','.icheck',function(){
        var _this = $(this);
        if (_this.prop('checked')) {
            _this.parents('a').addClass('selected');
        } else {
            _this.parents('a').removeClass('selected');
        }

        if ($J_listWrapper.find('a').length == $J_listWrapper.find('a.selected').length) {
            $J_checkAll.prop('checked',true);
        } else {
            $J_checkAll.prop('checked',false);
        }
    });

    /*
     * 删除按钮
     * */
    var _Del_Arr = [];
    $J_delBtn.on('click',function(){
        if ($J_listWrapper.find('a.selected').length == 0) {
            $.gohn._showTip('木有选中宝贝');
            return false;
        }
        if (window.confirm("确定要删除吗")) {
            $J_listWrapper.find('a.selected').each(function(){
                var $this = $(this)
                        ,$pid = $this.data('pid');
                _Del_Arr.push($pid);
                $this.remove();
            });
            console.log(_Del_Arr.join());
            $.ajax({
                method: "POST",
                url: "../assets/ajax/data-login.json",
                data: {pids: _Del_Arr.join()},
                dataType: "json",
                beforeSend: function(){
                    $J_delBtn.html('<img src="../assets/img/loading.gif" class="btn-loading"> 正在删除...');
                    $J_delBtn[0].disabled = true;
                }
            }).done(function(data){
                $.gohn._showTip('删除成功');
            }).fail(function(){
                $.gohn._showTip('请求失败');
            }).always(function(){
                $J_delBtn.html('删除');
                $J_delBtn[0].disabled = false;
            });
        }
    });
</script>
</body>
</html>